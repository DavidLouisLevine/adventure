10 KEY OFF:CLS
15 goto 270
20 SCREEN 0
30 WIDTH 40
40 P7$="같같같같같같같같같같같같같같같같같같같?:GOSUB 3480
50 P7$="겠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커?:GOSUB 3480
60 P7$="개                                   낡":GOSUB 3480
70 P7$="개            2078-A.BAS             낡":GOSUB 3480
80 P7$="개               CIA                 낡":GOSUB 3480
90 P7$="개                                   낡":GOSUB 3480
100 P7$="개                                   낡":GOSUB 3480
110 P7$="개 BROUGHT TO YOU BY THE MEMBERS OF  낡":GOSUB 3480
120 P7$="개      複複?複複?複複?複複?     낡":GOSUB 3480
130 P7$="개        ?  ?  ??    ?  ?     낡":GOSUB 3480
140 P7$="개        ?  白複??    ?  ?     낡":GOSUB 3480
150 P7$="개        ?  ?    ?    ?  ?     낡":GOSUB 3480
160 P7$="개      複白??    白複?白複?     낡":GOSUB 3480
170 P7$="개                                   낡":GOSUB 3480
180 P7$="개      International PC Owners      낡":GOSUB 3480
190 P7$="개                                   낡":GOSUB 3480
200 P7$="개P.O. Box 10426, Pittsburgh PA 15234낡":GOSUB 3480
210 P7$="개                                   낡":GOSUB 3480
220 P7$="걋컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸?:GOSUB 3480
230 P7$="같같같같같같같같같같같같같같같같같같같?:GOSUB 3480
240 P7$="":GOSUB 3480
250 P7$= "       PRESS ANY KEY TO CONTINUE:GOSUB 3480
260 REM A$=INKEY$: IF A$="" THEN 260
270 WIDTH 80
280 CLS
1010 REM  Pete Wohlmut 10-3-82
1000 REM  Translated from TRS-80 version	 on CPMNET BBS
1020 REM  Modified with automation by David Louis Levine on 2019-09-02
1025 REM DEF SEG= &H40
1030 REM POKE(&H17),PEEK(&H17) OR &H20  ' set Num Lock
1040 REM POKE (&H17),PEEK(&H17) OR &H40 ' set Caps Lock
1050 REM DEF SEG
1060 CLEAR:CLS:RANDOMIZE VAL(RIGHT$(TIME$,2)):DEFINT A-Z
1062 GOSUB 3600:GOTO 1090
1070 Z9=0:FOR R=1 TO 50:IF V1$=N$(R) AND (N(R)=LO OR N(R)=-1) THEN Z9=1:RETURN
1080 NEXT:P7$="I DON'T SEE THAT HERE.":GOSUB 3480:Z9=2:RETURN
1090 P7$="        C.I.A  ADVENTURE":GOSUB 3480
1100 DIM N1$(50),N$(50),N(50),V$(18),LO(30,4),LO$(30):FL=1:DR=0:DG=-1:T=0:EL=0:BU=0:DO=0:CA=0:BA=0:TE=0:GL=0
1110 PA=0:RO=0:FOR R=1 TO 5:R1=INT(9*RND(9)):CO$=CO$+STR$(R1):NEXT:LO=1:A9$=">"+STRING$(62,"-")+"<"
1120 R=LEN(CO$):CO$=RIGHT$(CO$,R-1)
1130 FOR R=1 TO 50:READ N1$(R),N$(R),N(R):NEXT
1140 FOR R=1 TO 30:READ LO$(R),LO(R,1),LO(R,2),LO(R,3),LO(R,4):NEXT
1150 FOR R=1 TO 18:READ V$(R):NEXT
1151 P2 = 3
1152 DIM P1$(P2)
1153 FOR R=1 TO P2:READ P1$(R):NEXT
1160 REM
1170 P7$="WE ARE "+LO$(LO)+".":GOSUB 3480
1180 FOR R=1 TO 46:IF N(R)=LO THEN P7$="I CAN SEE "+N1$(R)+".":GOSUB 3480
1190 NEXT:B=0:FOR R=1 TO 4:IF LO(LO,R)>0 THEN B=1
1200 NEXT:IF B=0 THEN 1250
1210 P7$="WE COULD EASILY GO: ":GOSUB 3520:IF LO(LO,1)>0 THEN P7$="NORTH  ":GOSUB 3520
1220 IF LO(LO,2)>0 THEN P7$="SOUTH  ":GOSUB 3520
1230 IF LO(LO,3)>0 THEN P7$="EAST  ":GOSUB 3520
1240 IF LO(LO,4)>0 THEN P7$="WEST  ":GOSUB 3520
1250 P7$="":GOSUB 3480:P7$= A9$:GOSUB 3480
1260 T=T+1:IF DG>0 THEN DG=DG-1
1270 IF T=1 THEN P7$=P1$[1]:GOSUB 3430:NA$=A7$:P7$= NA$:GOSUB 3480
1280 GOTO 2810
1290 N=0:FOR R=1 TO 46:IF N(R)=-1 THEN N=N+1
1300 NEXT
1310 P7$="":GOSUB 3480:P7$=P1$[2]:GOSUB 3430: A$=A7$
1320 GOSUB 2940:V$=LEFT$(A$,3):GOSUB 3000:FOR R=1 TO 18:IF V$=V$(R) THEN 1350 ELSE NEXT
1330 IF V$="ORD" THEN 3260
1340 P7$="I DON'T KNOW HOW TO DO THAT.":GOSUB 3480:GOTO 1310
1350 IF V$="QUI" THEN 2700
1360 V=R:FOR R=1 TO LEN(A$):IF MID$(A$,R,1)=" " THEN 1410 ELSE NEXT
1370 IF V$="LOO" THEN 1160
1380 IF V$="BON" THEN 2720
1390 IF V$="INV" THEN 2740
1400 P7$="PLEASE USE 2 WORD COMMANDS SO I CAN UNDERSTAND YOU.":GOSUB 3480:GOTO 1310
1410 V1$=MID$(A$,R+1,3):FOR R=1 TO 	49:IF V1$=N$(R) THEN 1440 ELSE NEXT
1420 IF V1$="NOR" OR V1$="SOU" OR V1$="EAS" OR V1$="WES" THEN 1440
1430 P7$="I DON'T KNOW WHAT IT IS YOU ARE TALKING ABOUT.":GOSUB 3480:GOTO 1310
1440 ON V GOTO 1450,1580,1670,1730,1850,1890,2090,2190,2350,2370,2410,2500,2540,2590,2650,2700,2720,2740
1450 IF V1$="NOR" AND LO(LO,1)>0 THEN LO=LO(LO,1):GOTO 1160
1460 IF V1$="SOU" AND LO(LO,2)>0 THEN LO=LO(LO,2):GOTO 1160
1470 IF V1$="EAS" AND LO(LO,3)>0 THEN LO=LO(LO,3):GOTO 1160
1480 IF V1$="WES" AND LO(LO,4)>0 THEN LO=LO(LO,4):GOTO 1160
1490 IF V1$="NOR" OR V1$="SOU" OR V1$="EAS" OR V1$="WES" THEN 1570
1500 GOSUB 1070:IF Z9=2 THEN 1260
1510 IF R=8 THEN LO=5:GOTO 1160
1520 IF R=37 AND RO=1 AND LO=20 THEN LO=21:GOTO 1160
1530 IF R=10 THEN LO=11:GOTO 1160
1540 IF R=14 THEN LO=13:GOTO 1160
1550 IF R=33 THEN LO=3:GOTO 1160
1560 IF R=34 AND DO=1 THEN LO=9:GOTO 1160
1570 P7$="I CAN'T GO THAT WAY AT THE MOMENT.":GOSUB 3480:GOTO 1260
1580 GOSUB 1070:IF Z9=2 THEN 1260
1590 IF R=2 OR R=3 OR R=4 OR R=6 OR R=15 OR R=16 OR R=20 OR R=21 OR R=22 OR R=23 OR R=25 OR R=26 OR R=27 OR R=28 OR R=30 OR R=31 OR R=37 OR R=39 OR R=40 OR R=42 OR R=44 OR R=45 OR R=46 THEN 1610
1600 P7$="I CAN'T CARRY THAT!":GOSUB 3480:GOTO 1260
1610 IF N(R)=-1 THEN P7$="I ALREADY HAVE IT.":GOSUB 3480:GOTO 1260
1620 IF N>=5 THEN P7$="I CAN'T CARRY ANYMORE.":GOSUB 3480:GOTO 1260
1630 P7$="O.K.":GOSUB 3480:N(R)=-1
1640 IF V1$="PAI" AND PA=0 THEN P7$="SOMETHING FELL FROM THE FRAME!":GOSUB 3480:N(31)=LO:PA=1
1650 IF V1$="TEL" THEN TE=0
1660 GOTO 1260
1670 FOR R=1 TO 46:IF V1$=N$(R) AND N(R)=-1 THEN 1690 ELSE NEXT
1680 P7$="I DON'T SEEM TO BE CARRYING IT.":GOSUB 3480:GOTO 1260
1690 IF R=30 THEN P7$="I DROPPED THE CUP BUT IT BROKE INTO SMALL PEICES.":GOSUB 3480:P7$="THE COFFEE SOAKED INTO THE GROUND.":GOSUB 3480:N(30)=0:DR=0:GOTO 1260
1700 IF R=45 THEN GL=0
1710 IF R=31 AND N(30)=-1 THEN P7$="O.K. I DROPPED IT.":GOSUB 3480:P7$="BUT IT FELL IN THE COFFEE!":GOSUB 3480:N(31)=0:DR=1:GOTO 1260
1720 P7$="O.K. I DROPPED IT.":GOSUB 3480:N(R)=LO:GOTO 1260
1730 IF V1$="BUT" AND LO=3 AND DO=0 THEN P7$="THE DOORS OPEN WITH A WHOOSH!":GOSUB 3480:DO=1:GOTO 1260
1740 IF N(46)=-1 AND V1$="BUT" THEN P7$="I PUSH THE BUTTON ON THE BOX AND":GOSUB 3480:GOTO 1820
1750 GOSUB 1070
1760 IF Z9=2 THEN 1260
1770 IF R=17 AND GL<>1 THEN P7$="THERE'S ELECTRICITY COURSING THRU THE SQUARE!":GOSUB 3480:P7$="I'M BEING ELECTROCUTED!":GOSUB 3480:GOTO 3380
1780 IF R=35 AND BU=0 THEN P7$="THE BUTTON ON THE WALL GOES IN .....":GOSUB 3480:P7$="CLICK! SOMETHING SEEMS DIFFFERENT NOW.":GOSUB 3480:BU=1:GOTO 1260
1790 IF R=47 AND FL<>1 THEN LO(9,1)=3:FL=1:GOTO 1840
1800 IF R=48 AND FL<>2 THEN LO(9,1)=8:FL=2:GOTO 1840
1810 IF R=49 AND FL<>3 THEN LO(9,1)=10:FL=3:GOTO 1840
1820 IF N(46)=-1 AND (LO=6 OR LO=29)THEN P7$="THERE IS A BLINDING FLASH....":GOSUB 3480:FORR=1TO3000:NEXT:LO=1:FL=1:LO(9,1)=3:GOTO 1160
1830 P7$="NOTHING HAPPENS.":GOSUB 3480:GOTO 1260
1840 P7$="THE DOORS CLOSE AND I FEEL AS IF THE ROOM IS MOVING.":GOSUB 3480:P7$="SUDDENLY THE DOORS OPEN AGAIN.":GOSUB 3480:FOR R=1 TO 5000:NEXT:GOTO 1160
1850 GOSUB 1070:IF Z9=2 THEN 1260
1860 IF R=18 AND GL<>1 THEN P7$="THE LEVER HAS ELECTRICITY COURSING THRU IT!":GOSUB 3480:P7$="I'M BEING ELECTROCUTED!":GOSUB 3480:GOTO 3380
1870 IF R=18 AND EL=0 THEN P7$="THE LEVER GOES ALL THE WAY UP AND CLICKS.":GOSUB 3480:P7$="SOMETHING SEEMS DIFFERENT NOW.":GOSUB 3480:EL=1:GOTO 1260
1880 P7$="NOTHING HAPPENS.":GOSUB 3480:GOTO 1260
1890 REM
1900 IF V1$="DRA" AND LO=5 THEN P7$="IT LOOKS FRAGILE.":GOSUB 3480:GOTO 1260
1910 GOSUB 1070:IF Z9=2 THEN 1260
1920 IF R=1 AND BA<>1 THEN P7$="THERE'S NO POWER FOR IT.":GOSUB 3480:GOTO 1260
1930 IF R=1 AND TE<>1 THEN P7$="THERE'S NO T.V. TO WATCH ON.":GOSUB 3480:GOTO 1260
1940 IF R=6 THEN P7$="IT LOOKS HEAVY.":GOSUB 3480:GOTO 1260
1950 IF R=7 THEN P7$="IT'S LOCKED.":GOSUB 3480:GOTO 1260
1960 IF R=13 THEN P7$="IT'S A VERY STRONG BAG.":GOSUB 3480:GOTO 1260
1970 IF R=19 THEN P7$="I CAN SEE A LOCKED DRAWER IN IT.":GOSUB 3480:GOTO 1260
1980 IF R=22 OR R=27 THEN P7$="THERE'S WRITING ON IT.":GOSUB 3480:GOTO 1260
1990 IF R=34 AND DO=1 THEN P7$="THE DOORS ARE OPEN.":GOSUB 3480:GOTO 1260
2000 IF R=24 THEN P7$="I CAN SEE A GLEAMING STONE IN IT.":GOSUB 3480:GOTO 1260
2010 IF R=9 THEN P7$="THERE IS A SMALL SLIT NEAR THE DOOR.":GOSUB 3480:GOTO 1260
2020 IF R=34 THEN P7$="THERE'S A BUTTON NEAR THE DOORS.":GOSUB 3480:GOTO 1260
2030 IF R=41 AND BU=1 THEN P7$="THE SCREEN IS DARK.":GOSUB 3480:GOTO 1260
2040 IF R=41 THEN P7$="I SEE A METAL PIT 1000'S OF FEET DEEP ON ONE MONITOR.":GOSUB 3480:P7$="ON THE OTHER SIDE OF THE PIT,I SEE A LARGE HOOK.":GOSUB 3480:GOTO 1260
2050 IF R=43 AND BU=1 THEN P7$="THE SCREEN IS DARK.":GOSUB 3480:GOTO 1260
2060 IF R=43 THEN P7$="I SEE A ROOM WITH A CASE ON A PEDESTAL IN IT.":GOSUB 3480:GOTO 1260
2070 IF R=44 THEN P7$="I SEE A PICTURE OF A GRINNING JACKAL.":GOSUB 3480:GOTO 1260
2080 P7$="I SEE NOTHING OF INTEREST.":GOSUB 3480:GOTO 1260
2090 GOSUB 1070:IF Z9=2 THEN 1260
2100 IF R<>3 AND R<>2 AND R<>4 AND R<>28 THEN P7$="I CAN'T INSERT THAT!":GOSUB 3480:GOTO 1260
2110 P7$=P1$[3]:GOSUB 3430: A3$=LEFT$(A7$,3)
2120 R1=R:V1$=A3$:GOSUB 1070:IF Z9=2 THEN 1260
2130 IF R1=3 AND R=1 THEN P7$="O.K.":GOSUB 3480:BA=1:N(3)=0:BA=1:GOTO 1260
2140 IF R1=4 AND R=50 AND DG<=0 THEN P7$="THE GUARD WON'T LET ME!":GOSUB 3480:GOTO 1260
2150 IF R1=2 AND R=1 THEN P7$="O.K. THE TAPE IS IN THE RECORDER.":GOSUB 3480:N(2)=0:TA=1:GOTO 1260
2160 IF R1=4 AND R=50 THEN P7$="POP! A SECTION OF THE WALL OPENS.....":GOSUB 3480:P7$="REVEALING SOMETHING VERY INTERESTING.":GOSUB 3480:N(4)=0:N(5)=LO:GOTO 1260
2170 IF R1=28 AND R=29 THEN P7$="POP! A CUP OF COFFEE COMES OUT OF THE MACHINE.":GOSUB 3480:N(28)=0:N(30)=LO:GOTO 1260
2180 P7$="NOTHING HAPPENED.":GOSUB 3480:GOTO 1260
2190 REM
2200 IF V1$="DRA" AND LO=5 AND N(23)=0 THEN P7$="IT's STUCK.":GOSUB 3480:GOTO 1260
2210 GOSUB 1070:IF Z9=2 THEN 1260
2220 IF R=7 OR R=9 OR R=13 OR R=15 OR R=23 OR R=32 OR R=5 THEN 2240
2230 P7$="I CAN'T OPEN THAT!":GOSUB 3480:GOTO 1260
2240 IF R=7 AND N(16)=-1 THEN P7$="O.K. I OPENED THE DOOR.":GOSUB 3480:N(7)=0:N(8)=4:GOTO 1260
2250 IF R=9 THEN P7$="I CAN'T. IT DOESN'T WORK.":GOSUB 3480:GOTO 1260
2260 IF R=13 AND N(16)=-1 THEN P7$="O.K. THE CLOSET IS OPENED.":GOSUB 3480:N(13)=0:N(14)=14:GOTO 1260
2270 IF R=15 THEN P7$="I CAN'T. IT'S TOO STRONG.":GOSUB 3480:GOTO 1260
2280 IF R=23 THEN P7$="IT'S STUCK.":GOSUB 3480:GOTO 1260
2290 IF R=32 AND N(28)=0 AND N(4)=0 AND SC=1 THEN P7$= "I OPEN THE SCULPTURE.":GOSUB 3480:P7$="SOMETHING FALLS OUT.":GOSUB 3480:N(28)=LO:N(4)=LO:GOTO 1260
2300 IF R<>5 THEN 2340
2310 INPUT"WHAT'S THE COMBINATION";C$
2320 IF C$=CO$ THEN P7$="THE DOOR IS SLOWLY OPENING.":GOSUB 3480:N(5)=0:N(9)=0:N(10)=10:GOTO 1260
2330 P7$="YOU MUST HAVE THE WRONG COMBINATION OR YOU ARE NOT":GOSUB 3480:P7$="SAYING IT RIGHT.":GOSUB 3480:GOTO 1260
2340 P7$="I CAN'T DO THAT......YET!":GOSUB 3480:GOTO 1260
2350 IF V1$="GLO" AND N(45)=-1 THEN P7$="O.K. I'M NOW WEARING THE GLOVES.":GOSUB 3480:GL=1:GOTO 1260
2360 P7$="I CAN'T WEAR THAT!":GOSUB 3480:GOTO 1260
2370 IF V1$<>"SIG" AND V1$<>"NOT" THEN P7$="I CAN'T READ THAT.":GOSUB 3480:GOTO 1260
2380 GOSUB 1070:IF Z9=2 THEN 1260
2390 IF R=22 THEN P7$="IT SAYS:GOSUB 3480:":P7$= NA$+",":GOSUB 3480:P7$="  WE HAVE DISCOVERED ONE OF CHAOSES SECRET WORDS.":GOSUB 3480:P7$="IT IS:GOSUB 3480: BOND-007- .TO BE USED IN A -TASTEFUL- SITUATION.":GOTO 1260
2400 IF R=27 THEN P7$="IT SAYS:GOSUB 3480: WATCH OUT! DANGEROUS!":GOTO 1260
2410 IF V1$<>"REC" THEN P7$="I CAN'T START THAT.":GOSUB 3480:GOTO 1260
2420 GOSUB 1070:IF Z9=2 THEN 1260
2430 IF BA<>1 OR TE<>1 OR TA<>1 THEN 2490
2440 P7$="THE RECORDER STARTS UP AND PRESENTS A SHORT MESSAGE:GOSUB 3480:"
2450 P7$=NA$+",":GOSUB 3480
2460 P7$="WE HAVE UNCOVERED A NUMBER THAT MAY HELP YOU.":GOSUB 3480
2470 P7$="THAT NUMBER IS"+CO$+". PLEASE WATCH OUT FOR HIDDEN TRAPS.":GOSUB 3480:
2480 P7$="ALSO, THERE IS SOMETHING IN THE SCULPTURE.":GOSUB 3480:SC=1:GOTO 1260
2490 P7$="NOTHING HAPPENED.":GOSUB 3480:GOTO 1260
2500 IF V1$<>"DRA" THEN P7$="I'M TRYING TO BREAK IT, BUT I CAN'T.":GOSUB 3480:GOTO 1260
2510 IF N(6)<>-1 THEN P7$="I CAN'T DO THAT YET.":GOSUB 3480:GOTO 1260
2520 IF LO=5 THEN P7$="IT'S HARD....BUT I GOT IT. TWO THINGS FELL OUT.":GOSUB 3480:N(3)=LO:N(22)=LO:N(23)=LO:GOTO 1260
2530 P7$="NOTHING HAPPENS.":GOSUB 3480:GOTO 1260
2540 GOSUB 1070:IF Z9=2 THEN 1260
2550 IF R<>15 AND R<>24 THEN P7$="I'M TRYING. IT DOESN'T WORK.":GOSUB 3480:GOTO 1260
2560 IF N(25)<>-1 THEN P7$="I CAN'T DO THAT YET.":GOSUB 3480:GOTO 1260
2570 IF R=15 THEN P7$="RIP! THE BAG GOES TO PIECES, AND SOMETHING FALLS OUT!":GOSUB 3480:N(15)=0:N(2)=LO:GOTO 1260
2580 IF R=24 THEN P7$="I CUT THE CASE AND REACH IN TO PULL SOMETHING OUT.":GOSUB 3480:N(26)=-1:GOTO 1260
2590 IF V1$<>"ROP" THEN P7$="I CAN'T THROW THAT.":GOSUB 3480:GOTO 1260
2600 IF N(37)<>-1 THEN P7$="I CAN'T DO THAT YET.":GOSUB 3480:GOTO 1260
2610 INPUT"TELL ME,IN ONE WORD,AT WHAT";A3$:A3$=LEFT$(A3$,3)
2620 IF A3$<>"HOO" THEN P7$="O.K. I THREW IT.":GOSUB 3480:N(37)=LO:GOTO 1260
2630 IF LO<>20 THEN P7$="I CAN'T DO THAT YET.":GOSUB 3480:GOTO 1260
2640 P7$="I THREW THE ROPE AND IT SNAGGED ON THE HOOK.":GOSUB 3480:RO=1:N(37)=LO:GOTO 1260
2650 IF V1$<>"TEL" THEN P7$="I CAN'T CONNECT THAT.":GOSUB 3480:GOTO 1260
2660 IF N(40)<>LO THEN P7$="I DON'T SEE THE TELEVISION HERE.":GOSUB 3480:GOTO 1260
2670 IF TE=1 THEN P7$="I DID THAT ALREADY.":GOSUB 3480:GOTO 1260
2680 IF LO<>2 THEN P7$="I CAN'T DO THAT....YET!":GOSUB 3480:GOTO 1260
2690 P7$="O.K. THE T.V. IS CONNECTED.":GOSUB 3480:TE=1:GOTO 1260
2700 P7$="WHAT? YOU WOULD LEAVE ME HERE TO DIE ALONE?":GOSUB 3480
2710 P7$="JUST FOR THAT, I'M GOING TO DESTROY THE GAME.":GOSUB 3480:P7$="":GOSUB 3480:P7$="":GOSUB 3480:P7$="":GOSUB 3480:P7$="BOOOOOOOOOOOOM!":GOSUB 3480:FOR R=1 TO 5000:NEXT:GOTO 3420
2720 IF LO=14 THEN P7$="WHOOPS! A TRAP DOOR OPENED UNDERNEATH ME AND":GOSUB 3480:P7$="I FIND MYSELF FALLING.":GOSUB 3480:FOR R=1 TO 4000:NEXT:LO=17:GOTO 1160
2730 P7$="NOTHING HAPPENED.":GOSUB 3480:GOTO 1260
2740 Z8=0:P7$="WE ARE PRESENTLY CARRYING":GOSUB 3480:FOR R=1 TO 46
2750 IF N(R)<>-1 THEN 2780
2760 P7$= N1$(R):GOSUB 3520:IF R=45 AND GL=1 THEN 2765 ELSE P7$=" ":GOSUB 3480:GOTO 2770
2765 P7$=". WHICH I'M WEARING.":GOSUB 3480
2770 Z8=1
2780 NEXT
2790 IF Z8=0 THEN P7$="NOTHING":GOSUB 3480
2800 GOTO 1260
2810 IF LO=3 AND N(39)=-1 THEN P7$="THE DOOR MAN LOOKS AT MY BADGE AND THEN THROWS ME OUT.":GOSUB 3480:FOR R=1 TO 5000:NEXT:LO=1:GOTO 1160
2820 IF LO=10 AND N(42)<>-1 THEN P7$="THE GUARD LOOKS AT ME SUSPICIOUSLY, THEN THROWS ME BACK.":GOSUB 3480:FOR R=1 TO 4000:NEXT:LO=9:GOTO 1160
2830 IF LO=6 AND BU<>1 THEN P7$="SIRENS GO OFF ALL AROUND ME!":GOSUB 3480:P7$="GUARDS RUN IN AND SHOOT ME TO DEATH!":GOSUB 3480:GOTO 3380
2840 IF LO=11 AND EL<>1 THEN P7$="THE FLOOR IS WIRED WITH ELECDRICITY!":GOSUB 3480:P7$="I'M BEING ELECTROCUTED!":GOSUB 3480:GOTO 3380
2850 IF LO=10 AND N(30)=-1 AND DR=1 THEN P7$="THE GUARD TAKES MY COFFEE":GOSUB 3480:P7$="AND FALLS TO SLEEP RIGHT AWAY.":GOSUB 3480:DG=5+INT(10*RND(10)):N(11)=0:N(12)=10:DR=0:N(30)=0:GOTO 1290
2860 IF DG=0 THEN P7$="I HEAR A NOISE LIKE SOMEONE IS YAWNING.":GOSUB 3480:N(11)=10:N(12)=0:GU=-2:DG=-1:GOTO 1290
2870 IF LO=1 AND N(26)=-1 THEN P7$="HURRAY! YOU'VE RECOVERED THE RUBY!":GOSUB 3480:P7$="YOU WIN!":GOSUB 3480:GOTO 3400
2880 IF T>375 THEN P7$="I THINK THEY ARE ON TO ME....I HEAR NOISES.":GOSUB 3480
2890 IF T=400 THEN P7$="OH NO! THEY CAUGHT UP TO ME! HELP! THEY'RE PULLING OUT GUNS!":GOSUB 3480:GOTO 3380
2900 IF T=1 THEN P7$="WRITING ON THE WALL SAYS:GOSUB 3480:":P7$="IF YOU WANT INSTRUCTIONS TYPE:GOSUB 3480:ORDERS PLEASE"
2910 IF LO=6 AND LO(6,2)<>0 THEN P7$="A SECRET DOOR SLAMS DOWN BEHIND ME!":GOSUB 3480:LO(6,2)=0:GOTO 1290
2920 IF LO=10 AND GU=-2 THEN P7$="THE GUARD DRAWS HIS GUN AND SHOOTS ME!":GOSUB 3480:GOTO 3380
2930 GOTO 1290
2940 IF A$="N" THEN A$="GO NORTH":RETURN
2950 IF A$="S" THEN A$="GO SOUTH":RETURN
2960 IF A$="E" THEN A$="GO EAST":RETURN
2970 IF A$="W" THEN A$="GO WEST":RETURN
2980 IF A$="I" THEN A$="INV":RETURN
2990 RETURN
3000 IF V$="WAL" OR V$="RUN" THEN V$="GO ":RETURN
3010 IF V$="TAK" OR V$="CAR" THEN V$="GET":RETURN
3020 IF V$="LEA" THEN V$="DRO":RETURN
3030 IF V$="PRE" THEN V$="PUS":RETURN
3040 IF V$="EXA" THEN V$="LOO":RETURN
3050 IF V$="PUT" THEN V$="INS":RETURN
3060 IF V$="UNL" THEN V$="OPE":RETURN
3070 IF V$="PLA" THEN V$="STA":RETURN
3080 IF V$="SMA" THEN V$="BRE":RETURN
3090 IF V$="ATT" THEN V$="CON":RETURN
3100 IF V$="LIS" THEN V$="INV":RETURN
3110 RETURN
3120 DATA A VIDEO CASSETTE RECORDER,REC,2,A VIDEO TAPE,TAP,0,A LARGE BATTERY,BAT,0,A BLANK CREDIT CARD,CAR,0,AN ELECTRONIC LOCK,LOC,0,AN ELABORATE PAPER WEIGHT,WEI,5,A LOCKED WOODEN DOOR,DOO,4,AN OPEN WOODEN DOOR,DOO,0,A SOLID LOOKING DOOR,DOO,10
3130 DATA AN OPEN DOOR,DOO,0,AN ALERT SECURITY GUARD,GUA,10,A SLEEPING SECURITY GUARD,GUA,0,A LOCKED MAINTENANCE CLOSET,CLO,14,A MAINTENANCE CLOSET,CLO,0,A PLASTIC BAG,BAG,13,AN OLDE FASHIONED KEY,KEY,9,A SMALL METAL SQUARE ON THE WALL,SQU,16
3140 DATA A LEVER ON THE SQUARE,LEV,16,AN OLD MAHOGANY DESK,DES,5,A BROOM,BRO,13,A DUSTPAN,DUS,13,A SPIRAL NOTEBOOK,NOT,0,A MAHOGANY DRAWER,DRA,0,A GLASS CASE ON A PEDESTAL,CAS,6,A RAZOR BLADE,BLA,27,A VERY LARGE RUBY,RUB,0,A SIGN ON THE SQUARE
3150 DATA SIG,16,A QUARTER,QUA,0,A COFFEE MACHINE,MAC,8,A CUP OF STEAMING HOT COFFEE,CUP,0,A SMALL CAPSULE,CAP,0,A LARGE SCULPTURE,SCU,3,A TALL OFFICE BUILDING,BUI,1,A PAIR OF SLIDING DOORS,DOO,3,A LARGE BUTTON ON THE WALL
3160 DATA BUT,29,A PANEL OF BUTTONS NUMBERED ONE THRU THREE,PAN,9,A STRONG NYLON ROPE,ROP,17,A LARGE HOOK WITH A ROPE HANGING FROM IT,HOO,21,A C.I.A. IDENTIFICATION BADGE,BAD,-1,A PORTABLE TELEVISION,TEL,7
3170 DATA A BANK OF MONITORS,MON,7,A CHAOS I.D. CARD
3180 DATA CAR,30,A BANK OF MONITORS,MON,19,A SMALL PAINTING,PAI,23,A PAIR OF RUBBER GLOVES,GLO,13,A BOX WITH A BUTTON ON IT,BOX,24,ONE,ONE,9,TWO,TWO,9,THREE,THR,9,SLIT,SLI,10,ON A BUSY STREET,0,0,0,0,IN A VISITOR'S ROOM,0,0,3,0
3190 DATA IN THE LOBBY OF THE BUILDING,1,0,4,2,IN A DINGY ANTE ROOM,0,0,0,3
3200 DATA IN THE COMPANY PRESIDENT'S OFFICE,0,0,0,4,IN A SMALL SOUND PROOFED CUBICLE,0,12,0,0,IN A SECURITY OFFICE,0,0,8,0,IN A SMALL HALLWAY,0,14,9,7,IN A SMALL ROOM,3,0,0,0,IN A SHORT CORRIDOR,0,15,0,9,IN A HALLWAY MADE OF METAL,0,0,12,10
3210 DATA IN A SMALL PLAIN ROOM,6,0,0,11
3220 DATA IN A MAINTENANCE CLOSET,0,0,14,0,IN A CAFETERIA,8,0,0,0,IN A SIDE CORRIDOR,10,0,16,0,IN A POWER GENERATOR ROOM,0,0,0,15,IN A SUB-BASEMENT BELOW THE CHUTE,0,0,18,0,IN THE ENTRANCE TO THE SECRET COMPLEX,0,20,19,17
3230 DATA IN A SECRET MONITORING ROOM,0,0,0,18,ON A LEDGE IN FRONT OF A METAL PIT 1000'S OF FEET DEEP,18,0,0,0,ON THE OTHER SIDE OF THE PIT,0,0,22,0,IN A LONG CORRIDOR,0,25,23,21,IN A LARGE ROOM,0,26,0,22,IN A SECRET LABORATORY,0,0,25,0
3240 DATA IN A NARROW CROSS CORRIDOR,22,0,0,24,IN A CROSS EXAMINATION ROOM,23,28,0,0,IN A SMALL BATHROOM,0,0,28,0,IN THE OFFICE OF THE CHIEF OF CHAOS,26,30,0,27,IN THE CHAOS CONTROL ROOM,0,0,30,0,NEAR THE END OF THE COMPLEX,28,0,0,29
3250 DATA "GO ",GET,DRO,PUS,PUL,LOO,INS,OPE,WEA,REA,STA,BRE,CUT,THR,CON,QUI,BON,INV
3555 DATA "ENTER YOUR NAME PARTNER? ", "WHAT DO YOU THINK WE SHOULD DO", "TELL ME, IN ONE WORD, INTO WHAT"

3260 P7$="YOUR MISSION,"+NA$+",IS TO RECOVER A RUBY THAT IS BEING":GOSUB 3480
3270 P7$="USED IN TOP SECRET GOVERNMENT PROJECTS AS A PART IN A":GOSUB 3480
3280 P7$="LASER PROJECTOR.":GOSUB 3480
3290 P7$="  YOU WILL HAVE A PARTNER WHO IS NOT TOO BRIGHT AND NEEDS":GOSUB 3480
3300 P7$="YOU TO TELL HIM WHAT TO DO. USE TWO WORD COMMANDS LIKE:GOSUB 3480:"
3310 P7$="":GOSUB 3480:P7$="              GET NOTEBOOK   GO WEST  LOOK DOOR":GOSUB 3480
3320 P7$="":GOSUB 3480:P7$="SOME COMMANDS USE ONLY ONE WORD. EXAMPLE:GOSUB 3480: INVENTORY"
3330 P7$="  IF YOU WANT TO SEE CHANGES IN YOUR SURROUNDINGS TYPE:GOSUB 3480: LOOK"
3340 P7$="THE RUBY HAS BEEN CAPTURED BY A SECRET SPY RING KNOWN AS":GOSUB 3480
3350 P7$="CHAOS. WE SUSPECT THEY ARE UNDER COVER SOMEWHERE IN THIS":GOSUB 3480
3360 P7$="NEIGHBORHOOD. GOOD LUCK!":GOSUB 3480
3370 GOTO 1290
3380 FOR R=1 TO 5000:NEXT:P7$="I'M DEAD!":GOSUB 3480
3390 P7$="YOU DIDN'T WIN.":GOSUB 3480
3400 INPUT"WOULD YOU LIKE TO TRY AGAIN (Y/N)";Z$
3410 IF Z$="Y" THEN RUN
3420 END
3430 REM Subroutine to input into A7$ using prompt P7$
3435 GOSUB 3520
3436 IF O1=0 THEN 3460
3437 IF EOF(2) THEN O1 = 0: CLOSE #2
3438 IF O1=0 THEN 3460
3440 P7$="? ":GOSUB 3520
3457 LINE INPUT #2, A7$:GOTO 3462
3460 PRINT #1, "? ";
3461 INPUT A7$
3462 PRINT #1, A7$:PRINT #3, A7$:IF O1<>0 THEN PRINT A7$
3463 IF LEFT$(A7$,1)="#" THEN 3436
3464 P4=0:IF O1<>2 THEN 3468
3465 FOR P3=1 TO P2:S1$=A7$:S2$=P1$[P3]:GOSUB 3560:IF P9=1 THEN P4=1
3466 NEXT P3
3467 IF P4=0 THEN 3436
3468 RETURN
3470 REM P7$=A7$:GOSUB 3480:RETURN
3480 REM TEE PRINT TO A FILE AND TO THE CONSOLE FROM VARIABLE P7$
3490 PRINT P7$
3500 PRINT #1, P7$
3510 RETURN
3520 REM TEE WITH NO CARRIAGE RETURN, PRINT TO A FILE AND TO THE CONSOLE FROM VARIABLE P7$
3530 PRINT P7$;
3540 PRINT #1, P7$;
3550 RETURN
3560 REM Subroutine set P9=1 if S1$ starts with S2$ else sets P9=0
3570 IF LEN(S1$) < LEN(S2$) THEN P9=0:RETURN
3580 IF LEFT$(S1$, LEN(S2$)) = S2$ THEN P9=1 ELSE P9=0
3590 RETURN
3600 REM Subroutine to open files
3610 OPEN "CIA.ADF" FOR INPUT AS #1
3620 LINE INPUT #1, F1$
3630 LINE INPUT #1, F2$
3640 LINE INPUT #1, F3$
3645 CLOSE #1
3650 OPEN F1$ FOR OUTPUT AS #1: 
3660 OPEN F2$ FOR INPUT AS #2:S1$=F2$:S2$=".ADC":GOSUB 3700:IF P9=1 THEN O1=1 ELSE O1=2
3670 OPEN F3$ FOR OUTPUT AS #3
3700 REM Subroutine sets P9=1 if S1$ ends with S2$ else sets P9=0
3710 IF LEN(S1$) < LEN(S2$) THEN P9=0:RETURN
3720 IF RIGHT$(S1$, LEN(S2$)) = S2$ THEN P9=1 ELSE P9=0
3730 RETURN
